<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proyecto Final Interactivo: Ajedrez y Pensamiento Estratégico</title>
    
    <!-- Librería de Reglas de Ajedrez -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chess.js/0.10.3/chess.min.js"></script>
    
    <!-- Hoja de Estilos de la nueva librería del tablero -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cm-chessboard@7/styles/cm-chessboard.css"/>

    <style>
        /* Tus estilos personalizados, con pequeños ajustes para el nuevo tablero */
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&family=Playfair+Display:wght@700&family=Noto+Serif:ital,wght@0,400;0,700;1,400&display=swap');
        
        body { font-family: 'Noto Serif', serif; line-height: 1.8; background-color: #f8f9fa; color: #212529; margin: 0; padding-top: 60px; scroll-behavior: smooth; }
        .container { max-width: 950px; margin: 20px auto; padding: 30px 50px; background: #ffffff; box-shadow: 0 10px 30px rgba(0,0,0,0.08); border-radius: 10px; border-top: 5px solid #005f73; }
        nav { position: fixed; top: 0; left: 0; width: 100%; background-color: #001219; padding: 10px 0; box-shadow: 0 3px 8px rgba(0,0,0,0.25); z-index: 1000; text-align: center; }
        nav a { color: #e9d8a6; text-decoration: none; font-family: 'Roboto', sans-serif; font-weight: 700; text-transform: uppercase; letter-spacing: 1px; margin: 0 15px; padding: 10px 15px; border-radius: 5px; transition: background-color 0.3s, color 0.3s; }
        nav a:hover { background-color: #94d2bd; color: #001219; }
        
        h1, h2, h3 { font-family: 'Playfair Display', serif; color: #005f73; }
        .project-subtitle { text-align: center; font-size: 1.4em; font-weight: bold; letter-spacing: 2px; text-transform: uppercase; color: #0a9396; margin-bottom: -10px; font-family: 'Playfair Display', serif;}
        h1 { font-size: 3em; text-align: center; margin-bottom: 25px; font-weight: 700; }
        h2 { font-size: 2.2em; border-bottom: 3px solid #94d2bd; padding-bottom: 15px; margin-top: 60px; }
        h3 { font-size: 1.6em; color: #0a9396; border-left: 4px solid #ee9b00; padding-left: 10px; }
        
        section { padding-top: 70px; margin-top: -60px; }
        p { font-size: 1.1em; text-align: justify; }

        #game-container { display: flex; flex-wrap: wrap; justify-content: center; align-items: flex-start; gap: 25px; }
        #board-container { width: 100%; max-width: 450px; } /* Contenedor para el nuevo tablero */
        #game-controls { flex-grow: 1; min-width: 300px; max-width: 400px; }
        
        .controls-nav button { font-family: 'Roboto', sans-serif; font-size: 1.1em; padding: 10px 18px; margin: 5px; border: 2px solid #005f73; background-color: #fff; color: #005f73; border-radius: 5px; cursor: pointer; transition: all 0.2s; }
        .controls-nav button:hover { background-color: #005f73; color: #fff; transform: translateY(-2px); }
        .controls-nav button:disabled { background-color: #ccc; border-color: #ccc; color: #666; cursor: not-allowed; transform: none; }
        
        #commentary { background-color: #eaf2f8; border-left: 5px solid #3498db; padding: 15px; margin-top: 20px; border-radius: 8px; min-height: 80px; font-style: italic; font-size: 1.05em; }
        .anexo-imagen { width: 100%; max-width: 600px; display: block; margin: 20px auto; border: 3px solid #dee2e6; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
    </style>
</head>
<body>
    
    <nav>
        <a href="#presentacion">Presentación</a>
        <a href="#desarrollo">Partida Interactiva</a>
        <a href="#anexos">Anexos</a>
    </nav>

    <div class="container">
        <section id="presentacion">
            <p class="project-subtitle">Proyecto Final</p>
            <h1>AJEDREZ Y PENSAMIENTO ESTRATÉGICO</h1>
        </section>

        <section id="desarrollo">
            <h2>Partida Interactiva</h2>
            <p>Utiliza los botones de navegación para reproducir la partida movimiento a movimiento. Los comentarios y reflexiones estratégicas aparecerán en la caja de comentarios para cada jugada clave.</p>
            
            <div id="game-container">
                <div id="board-container"></div>
                
                <div id="game-controls">
                    <div class="controls-nav">
                        <button id="startBtn">« Inicio</button>
                        <button id="prevBtn">‹ Anterior</button>
                        <button id="nextBtn">Siguiente ›</button>
                        <button id="endBtn">Fin »</button>
                    </div>
                    <h4>Estado Actual:</h4>
                    <div id="status" style="font-weight: bold; font-family: 'Roboto', sans-serif;"></div>
                    <h4>Comentarios de la Jugada:</h4>
                    <div id="commentary">¡Usa los botones para comenzar la partida!</div>
                </div>
            </div>
        </section>

        <section id="anexos">
            <h2>Anexos</h2>
            <h3>Anexo A: Fase de Apertura</h3>
            <img src="Pega_aqui_el_codigo_Base64_de_la_captura_de_APERTURA" alt="Captura de la Apertura" class="anexo-imagen">
            <h3>Anexo B: Momento del Enroque Corto</h3>
            <img src="Pega_aqui_el_codigo_Base64_de_la_captura_del_ENROQUE" alt="Captura del Enroque" class="anexo-imagen">
            <h3>Anexo C: Posición de Jaque Mate Final</h3>
            <img src="Pega_aqui_el_codigo_Base64_de_la_captura_del_JAQUE_MATE" alt="Captura del Jaque Mate Final" class="anexo-imagen">
        </section>
    </div>

<!-- Script del nuevo tablero: tipo "module" para que funcione correctamente -->
<script type="module">
    import { Chessboard } from "https://cdn.jsdelivr.net/npm/cm-chessboard@7/src/cm-chessboard/Chessboard.js"

    // --- CONFIGURACIÓN DE LA PARTIDA ---
    const game = new Chess(); // Cerebro de ajedrez
    const pgn = `[Event "Proyecto Final"]
[Site "Lichess.org"]
[Date "2024.07.15"]
[White "Luis Anderson Novoa Ramirez"]
[Black "Oponente"]
[Result "1-0"]

1. e4 c5 2. Nf3 Nc6 3. Bc4 e6 4. d3 a6 5. Bg5 f6 6. Bh4 b6 7. b3 Nge7 8. O-O h6 9. Ba3 Qa5 10. Bb2 d6 11. Qd2 g5 12. Bg3 e5 13. h4 Qb4 14. c3 Qa5 15. b4 cxb4 16. cxb4 Qa4 17. Bb3 Qb5 18. a3 a5 19. Nc3 Qa6 20. b5 Qb7 21. bxc6 Qxc6 22. Ba4 b5 23. Bxb5 Qd7 24. Bxd7+ Bxd7 25. d4 exd4 26. Nxd4 gxh4 27. Bxh4 Ng6 28. Bxf6 Rg8 29. Nd5 Rc8 30. Rac1 Rxc1 31. Rxc1 Ne5 32. Bxe5 dxe5 33. Nf6+ Kf7 34. Nxd7 exd4 35. Qxd4 Bxa3 36. Rc7 Ke6 37. Nc5+ Bxc5 38. Qxc5 Rd8 39. Qe7# 1-0`;
    
    game.load_pgn(pgn);
    const history = game.history({ verbose: true });
    let currentMove = -1;

    const comments = {
        1: "El oponente inicia con la Defensa Siciliana (1...c5), una respuesta aguda y asimétrica contra 1.e4.",
        8: "Enroque corto. La seguridad del rey es la prioridad principal antes de comenzar operaciones en el centro o los flancos.",
        33: "Este jaque con el caballo (Nf6+) marca el punto de inflexión. El rey negro pierde su última defensa y queda expuesto al ataque.",
        39: "¡Jaque Mate! La Dama, sin oposición, da el golpe final. Una victoria lograda a través de la táctica y el ataque al rey."
    };

    const boardContainer = document.getElementById("board-container");
    const board = new Chessboard(boardContainer, {
        position: "start",
        // Las piezas SVG están integradas por defecto. No se necesita URL externa.
    });

    // --- LÓGICA DE ACTUALIZACIÓN Y NAVEGACIÓN ---
    function updateDisplay() {
        const turn = game.turn() === 'w' ? 'Blancas' : 'Negras';
        let statusText = `Turno de las ${turn}`;
        
        if (game.in_checkmate()) { statusText = `Jaque Mate. Ganan las ${turn === 'b' ? 'Blancas' : 'Negras'}.`; } 
        else if (game.in_draw()) { statusText = 'Partida terminada en tablas.'; }
        
        document.getElementById("status").innerText = statusText;
        
        let commentText = "¡Usa los botones para comenzar la partida!";
        if (currentMove >= 0) {
            const moveNumber = Math.floor(currentMove / 2) + 1;
            const moveData = history[currentMove];
            commentText = comments[moveNumber] || `Jugada ${moveNumber}: ${moveData.san}`;
        }
        document.getElementById("commentary").innerText = commentText;

        // Habilitar/deshabilitar botones
        document.getElementById("startBtn").disabled = currentMove < 0;
        document.getElementById("prevBtn").disabled = currentMove < 0;
        document.getElementById("nextBtn").disabled = currentMove >= history.length - 1;
        document.getElementById("endBtn").disabled = currentMove >= history.length - 1;
    }

    // Navegación
    document.getElementById("startBtn").addEventListener("click", () => {
        game.reset();
        board.setPosition(game.fen());
        currentMove = -1;
        updateDisplay();
    });
    
    document.getElementById("prevBtn").addEventListener("click", () => {
        if (currentMove < 0) return;
        game.undo();
        board.setPosition(game.fen());
        currentMove--;
        updateDisplay();
    });

    document.getElementById("nextBtn").addEventListener("click", () => {
        if (currentMove >= history.length - 1) return;
        currentMove++;
        game.move(history[currentMove]);
        board.setPosition(game.fen());
        updateDisplay();
    });

    document.getElementById("endBtn").addEventListener("click", () => {
        game.load_pgn(pgn);
        board.setPosition(game.fen());
        currentMove = history.length - 1;
        updateDisplay();
    });

    // Inicializar
    updateDisplay();
</script>
</body>
</html>
