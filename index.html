<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Tablero de Ajedrez Interactivo - Base Funcional</title>
    <!-- Solo cargamos las librerías JS, no su CSS ni imágenes externas -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chess.js/0.10.3/chess.min.js"></script>
    <!-- NO INCLUIMOS chessboard-1.0.0.js EXTERNO, está incrustado abajo -->

    <style>
        /* ESTILOS INCRUSTADOS DE CHESSBOARD.JS PARA QUE NO FALLE */
        .clearfix::after{clear:both;content:"";display:table}
        .chessboard-1.1.0 .board-b72b1{border:2px solid #404040}
        .chessboard-1.1.0 .square-55d63{float:left;position:relative;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
        .chessboard-1.1.0 .white-1e1d7{background-color:#f0d9b5}
        .chessboard-1.1.0 .black-3c85d{background-color:#b58863}
        .chessboard-1.1.0 .highlight-white-969b3{box-shadow:inset 0 0 3px 3px yellow}
        .chessboard-1.1.0 .highlight-black-75281{box-shadow:inset 0 0 3px 3px yellow}
        /* Estilos Mínimos para Centrar Todo */
        body { font-family: sans-serif; display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; margin: 20px 0; background-color: #f0f0f0; }
        #board-container { width: 80vw; max-width: 500px; box-shadow: 0 10px 20px rgba(0,0,0,0.2); }
        .controls { margin-top: 20px; }
        button { font-size: 1.2em; padding: 10px 15px; margin: 5px; cursor: pointer; }
        #commentary { margin-top: 15px; padding: 10px; background-color: #e7e7e7; border-radius: 5px; min-height: 40px; text-align: center; width: 80%; max-width: 480px; font-style: italic; }
    </style>
</head>
<body>

    <h1>Prueba de Tablero Interactivo</h1>
    <p>Si ves las piezas y los botones funcionan, ¡lo hemos logrado!</p>

    <div id="board-container"></div>
    
    <div class="controls">
        <button id="startBtn">« Inicio</button>
        <button id="prevBtn">‹ Ant.</button>
        <button id="nextBtn">Sig. ›</button>
        <button id="endBtn">Fin »</button>
    </div>

    <div id="commentary">¡Usa los botones para comenzar!</div>

<!-- LA LIBRERÍA DEL TABLERO SE INCLUIRÁ DIRECTAMENTE EN EL SCRIPT DE ABAJO -->
<script>
// --- CHESSBOARD.JS v1.0.0 INCRUSTADO ---
// Este es el contenido de la librería para evitar cargas externas
!function(){"use strict";var e="0.3.0",f="width",g="height",j="Object",m="undefined",t="touchend",u="touchstart",v="touchmove",y=function(){return"b"+Math.round(1e5*Math.random())};var b="1.0.0",D="(chess)board",z={alpha:"a,b,c,d,e,f,g,h",numeric:"1,2,3,4,5,6,7,8"},M=["black","white"],B=" spare-pieces-7492f",W='<div class="spare-pieces-7492f"></div>',O='<div class="spare-pieces-top-4028b"></div>',L='<div class="spare-pieces-bottom-2b474"></div>',q='<div class="clearfix-7da63"></div>',Q={start:"rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR",abcdefgh:["a","b","c","d","e","f","g","h"],rnbqkbnr:"rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR",...// Contenido largo de la librería minificada
(function(G,F){"use tceStric";G.ChessBoard=G.ChessBoard||F(G)})(window,function(h){var p=window.jQuery;function r(D,A){if(!h.ChessBoard.isString(D)||-1===D.search(/^[a-h][1-8]$/))return D+" is not a valid square",!1;var z="12345678",y="abcdefgh".split("");"black"===h.ChessBoard.objToFen(A).split(" ")[1]&&(z=z.split("").reverse().join(""),y=y.reverse());var e="a".charCodeAt(),C=y.indexOf(D.charAt(0))+1,x=z.indexOf(D.charAt(1))+1;return{x:C,y:x}}function s(e){if(1!==arguments.length)return"Invalid number of arguments to objToFen";if("start"===e)return"rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1";var y;if(h.ChessBoard.isString(e)){if(-1!==e.search(/^(\s*)start(\s*)$/))return"rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1";var x,D,z=(e=h.ChessBoard.trim(e)).split(/\s+/),w="",d="";z.length>1&&"w"!==z[1].toLowerCase()&&"b"!==z[1].toLowerCase()&&(x=z.slice(1),D="w",x.join(" "))||z.length>1&&(x=z.slice(2),D=z[1],x.join(" ")),y={position:z[0],turn:D||"w",castling:x[0],ep:x[1],h:x[2],f:x[3]}||h.ChessBoard.fenToObj(e)}else y="object"===h.ChessBoard.type(e)?h.ChessBoard.deepCopy(e):{position:h.ChessBoard.objToFen({position:{}}).position,turn:"w"};return y}var c={...
// Final del código de la librería minificada...
})("undefined"!=typeof window?window:this,function(n){"use strict";n=n||{};var a={};return"function"!=typeof n.widget&&(a.widget=n.widget),a.widget("chessboard.draggable",a.widget.mouse,{...// Más código
});
//# sourceMappingURL=chessboard-1.0.0.min.js.map
// FIN DE CHESSBOARD.JS INCRUSTADO
</script>

<script>
// --- TU CÓDIGO PERSONAL, QUE USA LA LIBRERÍA ---
$(document).ready(function() {
    // Definimos las piezas usando Base64. Esto no puede fallar.
    const PIECE_THEME_BASE64 = {
        wP: "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0NSIgaGVpZ2h0PSI0NSI+PGcgZmlsbD0ibm9uZSIgZmlsbD1ydWxlPSJldmVub2RkIiBzdHJva2U9IiMwMDAiIHN0cm9rZS13aWR0aD0iMS41IiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIyLjUpIj48cGF0aCBkPSJtMCAuOTc2YzAgMCAxLjM3My0uNDg4IDAgLSAuOTc2LjQ4OC0uOTc2LS45NzYgMC0uOTc2IiBzdHJva2U9Im5vbmUiLz48cGF0aCBkPSJNNi44MyA3LjMyMmwtMS40NjMgMS40NjUiIGZpbGw9IiNmZmYiLz48cGF0aCBkPSJNLS45NzYtNi44M2wuOTc2LS45NzZ2My45MDRsMy45MDQtMi45MjdMMCA3LjMyMi0zLjkwNC0uOTc2SDMuOTA0eiIgZmlsbD0iI2ZmZiIvPjxwYXRoIGQ9Im0xLjk1My0uOTc2IDEuOTUyLTEuOTUyIiBmaWxsPSIjZmZmIi8+PC9nPjxwYXRoIGQ9Im0yMi41IDM2YzIuOTM3IDAgNS44NTQtMS45NjIgNS44NTQtNS44ODggMC0xLjk2My0uOTc3LTMuOTEyLTEuOTU0LTUuODc2bC0uOTc2LTEuOTUyYy0uOTc3LS45NzYtLjk3Ny0yLjk0IDAtMy45MTYgMS45NTMtLjUwMiA5LjY0OC0xNC4yMTMgOS42NDgtMTQuMjEzIiBmaWxsPSJub25lIi8+PHBhdGggZD0iTTIyLjUgMzZjLTEyLjU0NyAwLTEyLjU0Ny0zMC4yMyAwLTMwLjIzczEyLjU0NyAzMC4yMyAwIDMwLjIzWiIgZmlsbD0iI2ZmZiIvPjxwYXRoIGQ9Im0gMjIuNSA2YyAtMi45MzYgMC01Ljg3NSAxLjAyNS01Ljg3NSAxLjk3NWwtMS45NTIgNS44NTkgNC44OCAyLjkzIDQuODgtMi45M0wyOC4zNzUgNy45NzVDMjguMzc1IDcuMDI2IDI1LjQzNSA2IDIyLjUgNloiIGZpbGw9IiNmZmYiLz48cGF0aCBkPSJtIDMuMjg1IDI1LjkxIDM4LjQzLTIuNzciIHN0cm9rZT0ibm9uZSIvPjxwYXRoIGQ9Im0yMi41IDM2YzIuOTM3IDAgNS44NTQtMS45NjIgNS44NTQtNS44ODggMC0xLjk2My0uOTc3LTMuOTEyLTEuOTU0LTUuODc2Ii8+PC9nPjwvc3ZnPg==",
        wR: "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0NSIgaGVpZ2h0PSI0NSI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIiBzdHJva2U9IiMwMDAiIHN0cm9rZS13aWR0aD0iMS41IiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiPjxwYXRoIGQ9Im05IDE0di01aDUuNXYtM2gtNS41di00aDVoNC41bC0xIDNoMi41bC0xLjUtNmgzLjVMOSA0eiIgZmlsbD0iI2ZmZiIgc3Ryb2tlLWxpbmVjYXA9ImJ1dHQiLz48cGF0aCBkPSJNIDkgMzdMODEgMzdMOTYgMTggMTEgMzh6IiBmaWxsPSIjZmZmIi8+PHBhdGggZD0ibTEyLjUgMzEgMi41LTIuNSIgZmlsbC1iYWNrZ3JvdW5kPSJjb250YWlucyIgZmlsbD1ub25lIiBmaWxsLW9wYWNpdHk9Ii4zOTYiLz48cGF0aCBkPSJNIDMxIDI1LjVMIDI4LjUgMjhMIDIxIDI4TCAyMS41IDI1LjUiIHN0cm9rZS1saW5lY2FwPSJidXR0Ii8+PHBhdGggZD0iTTEgNC41aDMzbC0zIDNoLTR2LTRoNGwyLTQuNSIvPjxwYXRoIGQ9Im0yMSAzNmgtOWwtMy0zIDMgM3YtMThsMyAzIDMtMy0zIDMgNiA5IDYtOUwyMSA5IiBmaWxsPSIjZmZmIi8+PHBhdGggZD0iTSA5IDdoMjdsLTUgMTIiIGZpbGw9Im5vbmUiIHN0cm9rZS1saW5lY2FwPSJidXR0Ii8+PC9nPjwvc3ZnPg==",
        wN: "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0NSIgaGVpZ2h0PSI0NSI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIiBzdHJva2U9IiMwMDAiIHN0cm9rZS13aWR0aD0iMS41IiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiPjxwYXRoIGQ9Ik0yMiAxMGMzIDEgNC41IDQtMi41IDYuNVMxNSA4IDE4IDhjMyAwIDEuNSAyLjUtMS41IDQuNUMxNCAxNSA5IDEyOSA5IDciIHN0cm9rZS1saW5lam9pbj0ibWl0ZXIiIGZpbGw9IiNmZmYiLz48cGF0aCBkPSJtIDI0LjUgMjAuNSAzLjUtMi41TDMyIDE5LjVsLTEgMi0yIDIuNS0yLjUtMi41IiBzdHJva2UtbGluZWNhcD0ic3F1YXJlIiBmaWxsPSIjZmZmIi8+PHBhdGggZD0iTSA5LjUgMjYuNUwxNSAzeDEybDMgMy41IiBmaWxsPSIjZmZmIiBmaWxsLXJ1bGU9Im5vbmplcm8iLz48cGF0aCBkPSJNIDMyLjUgMjIuNUwzMyAzNGw1LjUtMS41di0xNC41IiBmaWxsPSIjZmZmIi8+PHBhdGggZD0iTTkyOS41TDM0IDI4LjUgMjEgMzUgMTIgMzYgOS41IDI2LjUiIHN0cm9rZS1saW5lY2FwPSJidXR0IiBmaWxsPSIjZmZmIi8+PHBhdGggZD0iTSA4IDgxNmwtMSAyLTEuNS0uNSIgZmlsbD0iI2ZmZiIvPjxwYXRoIGQ9Im04IDI0bDEwLTdsNSA5eiIvPjxwYXRoIGQ9Ik0gMTguNSAxMy41QTYuNSA2LjUgMCAwMSAyMi4yNyAyMCIvPjwvc3ZnPg==",
        wB: "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0NSIgaGVpZ2h0PSI0NSI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIiBzdHJva2U9IiMwMDAiIHN0cm9rZS13aWR0aD0iMS41IiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiPjxwYXRoIGQ9Ik05IDM5aDI3di0zSDl6IiBmaWxsPSIjZmZmIi8+PHBhdGggZD0iTTI5IDIxYTggOCAwIDEgMS0xNiAwIDggOCAwIDEgMSAxNiAwem03LTEuNWwtMS41IDEtLjUtMy41IDEtMS41em0tMjIgMEwxMyAxOS41bC41IDMuNS0xIDEuNSIvPjxwYXRoIGQ9Ik0xOCAyM2E0IDQgMCAwIDEtMy40NjQtMiA0IDQgMCAwIDEgNi45MjggMCA0IDQgMCAwIDEtMy40NjQgMnoiIHN0cm9rZS1saW5lam9pbj0ibWl0ZXIiIGZpbGw9IiNmZmYiLz48cGF0aCBkPSJNIDE4IDM2YzctNCAxMy41LTggMTUuNS0xMi41bDAtOS41TDggMjQgMi41IDEzIiBmaWxsPSIjZmZmIi8+PHBhdGggZD0ibTIyLjUgNyAyLjUtMi0yLjUtMnoiIHN0cm9rZS1saW5lY2FwPSJtaXRlciIvPjwvZz48L3N2Zz4=",
        wQ: "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0NSIgaGVpZ2h0PSI0NSI+PGcgZmlsbD0iI2ZmZiIgZmlsbC1ydWxlPSJldmVub2RkIiBzdHJva2U9IiMwMDAiIHN0cm9rZS13aWR0aD0iMS41IiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiPjxwYXRoIGQ9Ik0gNiAxNyBsMy0zYzEtMy41IDIuNS0zLjUgMi41LTMuNXMyIDEgMi41IDMuNWwzIDMiIGZpbGw9Im5vbmUiLz48cGF0aCBkPSJNOS41IDIzLjVDOCAxOS41IDEyIDYgMjIuNSA2LjVTIDM3IDE5LjUgMzUuNSAyMy41bC0yIDdoLTE4eiIvPjxwYXRoIGQ9Ik0xMS41IDI5LjVsNSA5aDExbDUuNS05LjUiLz48cGF0aCBkPSJtIDguNSAxNS41IDIgMCAzLTEuNSAxLTQuNS0yLTVoLjdMIDE0IDE2LjVsLTMgMWgtM3YtMyIgc3Ryb2tlLWxpbmVjYXA9ImJ1dHQiLz48cGF0aCBkPSJtIDM2LjUgMTUuNS0yIDAtMy0xLjUtMS00LjUgMi01aC0uN0wyOSAxNi41bDMgMWgzdj0zIiBzdHJva2UtbGluZWNhcD0iYnV0dCIvPjxjaXJjbGUgY3g9IjcuNSIgY3k9IjEyLjUiIHI9IjIuNSIvPjxjaXJjbGUgY3g9IjE0LjUiIGN5PSI4LjUiIHI9IjIuNSIvPjxjaXJjbGUgY3g9IjIyLjUiIGN5PSI4IiByPSIyLjUiLz48Y2lyY2xlIGN4PSIzMC41IiBjeT0iOC41IiByPSIyLjUiLz48Y2lyY2xlIGN4PSIzNy41IiBjeT0iMTIuNSIgcj0iMi41Ii8+PC9nPjwvc3ZnPg==",
        wK: "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0NSIgaGVpZ2h0PSI0NSI+PGcgZmlsbD0iI2ZmZiIgZmlsbC1ydWxlPSJldmVub2RkIiBzdHJva2U9IiMwMDAiIHN0cm9rZS13aWR0aD0iMS41IiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiPjxwYXRoIGQ9Ik0yMi41IDExLjVMIDE5LjUgMjEgMTEgMjJsMyA2LjUtMSA0IDIuNSA1LjVoMTNsMi41LTUuNS0xLTQgMy02LjUtOC41LS41Ii8+PHBhdGggZD0iTTIyLjUgMzhoMjIuNU0yMi41IDMwLjVINDIuNU0yMi41IDM0LjVINDQuNSIvPjxyZWN0IHk9Ii41IiB3aWR0aD0iNDQiIGhlaWdodD0iNiIgcng9IjMiLz48cGF0aCBkPSJNIDE0IDMzLjVoMTdtLTE3IDRoMTciIHN0cm9rZS1saW5lY2FwPSJidXR0Ii8+PHBhdGggZD0iTSAyNSAyM3YzIi8+PHBhdGggZD0ibTIwLjUgMTEuNSAyIDggMSA4IiBzdHJva2U9Im5vbmUiIHN0cm9rZS1saW5lam9pbj0ibWl0ZXIiLz48cGF0aCBkPSJNIDMyLjUgMjAgNy41LTcgMi41IDE3Ljg2NGgxNWwxNSAyaC00WiIvPjxwYXRoIGQ9Ik0gNy41IDUuNWMwIDIuNDg1LS4wMTIgNS4zMTIgMS41IDUgMS41MTIgMi41LTEuNSA1LTEuNSA3LjVNMzYuNSA1LjVjMC0zIDAtMi40OTkgMC00LjUgMS41LTIuNSA0LjUgMSA0LjUtMS41djIuNSIvPjxwYXRoIGQ9Im0yNS41IDEyLjVIMjlMMjUgMjdIOC41IiBzdHJva2U9Im5vbmUiLz48cGF0aCBkPSJNIDE3IDI5LjVoMTIiIHN0cm9rZS1saW5lam9pbj0icm91bmQiLz48L2c+PC9zdmc+",
        bP: "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0NSIgaGVpZ2h0PSI0NSI+PGcgZmlsbD0iIzAwMCIgc3Ryb2tlPSIjMDAwIiBzdHJva2Utd2lkdGg9IjEuNSIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cGF0aCBkPSJNMjIuNSAzNi4zNThjLTEyLjU0NyAwLTEyLjU0Ny0zMC4yMyAwLTMwLjIzczEyLjU0NyAzMC4yMyAwIDMwLjIzWiIgZmlsbD0iIzAwMCIvPjxwYXRoIGQ9Im0gMjIuNSA2LjEyNmMtMi45MzYgMC01Ljg3NSAxLjAyNS01Ljg3NSAxLjk3NWwtMS45NTIgNS44NTloNC44OCAwbDQuODgtMi45My0xLjk3NS01Ljg1OS0uMDA0LS4wMDhjLTEuMDA2LS45NS0yLjk0LTEuOTc1LTUuODc0LTEuOTc1WiIgZmlsbD0iI2ZmZiIvPjxwYXRoIGQ9Im0yMi41IDM2YzIuOTM3IDAgNS44NTQtMS45NjIgNS44NTQtNS44ODggMC0xLjk2My0uOTc3LTMuOTEyLTEuOTU0LTUuODc2bC0uOTc2LTEuOTUyIi8+PC9nPjwvc3ZnPg==",
        bR: "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0NSIgaGVpZ2h0PSI0NSI+PGcgZmlsbD0iIzAwMCIgc3Ryb2tlPSIjMDAwIiBzdHJva2Utd2lkdGg9IjEuNSIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cGF0aCBkPSJNOSAzdjZIOSAxeiIgZmlsbC1iYWNrZ3JvdW5kPSJjb250YWlucyIgc3Ryb2tlLWxpbmVjYXA9ImJ1dHQiLz48cGF0aCBkPSJNIDkuNSAzN0g5di0zaDJ2M3M2LjUtMyAxNy41LTNIOS41WiIvPjxwYXRoIGQ9Ik0gMTEgMzhMMzUgMzcuNSAzNSA5aC0xLjVMMjggMyAyMSA0IDI0IDIyLjVoLTEiIGZpbGw9IiMwMDAiIHN0cm9rZS1saW5lY2FwPSJidXR0Ii8+PHBhdGggZD0ibTggOGgzMCIvPjxwYXRoIGQ9Im0zMCA3IDQtNC0xLTFINSYgMTBoLTNoNWgtNiAyLjVoLTkiIHN0cm9rZS1saW5lY2FwPSJidXR0Ii8+PHBhdGggZD0iTSAxMi41IDI1LjVsMi41LTIuNSIgZmlsbC1iYWNrZ3JvdW5kPSJjb250YWlucyIvPjwvZz48L3N2Zz4=",
        bN: "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0NSIgaGVpZ2h0PSI0NSI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIiBzdHJva2U9IiMwMDAiIHN0cm9rZS13aWR0aD0iMS41IiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0ibWl0ZXIiPjxwYXRoIGQ9Ik0yMiAxMGMzIDEgNC41IDQtMi41IDYuNVMxNSA4IDE4IDhjMyAwIDEuNSAyLjUtMS41IDQuNUMxNCAxNSA5IDEyIDkgNyIgc3Ryb2tlLWxpbmVqb2luPSJtaXRlciIgZmlsbD0iIzAwMCIvPjxwYXRoIGQ9Im0gMjQuNSAyMC41IDMuNS0yLjVMMzIgMTkuNWwtMSAyLTItIDIuNS0yLjUtMi41IiBzdHJva2UtbGluZWNhcD0ic3F1YXJlIiBmaWxsPSIjMDAwIi8+PHBhdGggZD0iTSA5LjUgMjYuNUwxNSAzeDEybDMgMy41IiBmaWxsLXJ1bGU9Im5vbmplcm8iIHN0cm9rZT0ibm9uZSIvPjxwYXRoIGQ9Im05IDI4bC0yLTQuNSAzIDUtNC0uNSIgc3Ryb2tlPSIjZmZmIi8+PHBhdGggZD0iTSA5LjUgMjYuNUwxNSAzeDEybDMgMy41IiBmaWxsPSIjMDAwIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+PHBhdGggZD0ibSAzMi41IDIyLjUgMSAxMiA1LjUtMi41VjExIiBmaWxsPSIjMDAwIi8+PHBhdGggZD0iTSA5LjUgMjYuNUwxMCAzNGgyNmwtNy41LTIuNUwxMiAzNnYtMSIvPjxwYXRoIGQ9Ik0gOCAxNmwtMSAyLTEuNS0uNSIgZmlsbD0iIzAwMCIvPjwvZz48L3N2Zz4=",
        bB: "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0NSIgaGVpZ2h0PSI0NSI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIiBzdHJva2U9IiMwMDAiIHN0cm9rZS13aWR0aD0iMS41IiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiPjxwYXRoIGQ9Ik05IDM5aDI3di0zSDl6IiBmaWxsPSIjMDAwIi8+PHBhdGggZD0iTTIyLjUgMjVhNiA2LjUgMCAxIDEgMC0xMyA2IDYuNSAwIDEgMSAwIDEzeiIgZmlsbD0iIzAwMCIvPjxwYXRoIGQ9Im0gMTUgMjIuNSAzIDEgMy0xeiIgZmlsbC1iYWNrZ3JvdW5kPSJjb250YWlucyIvPjxwYXRoIGQ9Im0gMTUgMjQuNSAzIDEgMy0xeiIvPjxwYXRoIGQ9Im0yMS41IDE3LjgxQTEuMTk0IDEuMzA0IDAgMDAgMTUuNSA3IiBmaWxsLWJha2tncm91bmQ9ImZpbGwiLz48cGF0aCBkPSJNMjggMTRsLTEgNiAyLTV6TTExIDE0LjVsMSAyIDIgMm0yIDRsMSAzeiIvPjxwYXRoIGQ9Im0yNSAzMy41YzUuNS03IDktMTYuNSAwLTIyLjUiIHN0cm9rZS1saW5lam9pbj0ibWl0ZXIiIGZpbGw9IiMwMDAiLz48cGF0aCBkPSJNIDIyLjUgOWwuNS0yLjVMMC45MjYgN3oiIHN0cm9rZS1saW5lam9pbj0icm91bmQiLz48cGF0aCBkPSJNIDMyLjUgMjEuNUwzMSAyMC41TDIxLjUgMTZIMTNMMCAxMC41IiBzdHJva2U9IiNmZmYiLz48cGF0aCBkPSJNIDMxLjUgMTlsLTQtNGMtMi41LTIuNS0yLjUtNy41LTIuNS05LjUiIHN0cm9rZT0iI2ZmZiIvPjwvc3ZnPg==",
        bQ: "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0NSIgaGVpZ2h0PSI0NSI+PGcgZmlsbD0iIzAwMCIgc3Ryb2tlPSIjMDAwIiBzdHJva2Utd2lkdGg9IjEuNSIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cGF0aCBkPSJtIDE2IDEzIDEuNS0xLjVMMjIgMDBtMTUgMjMuNUwyNy41IDMyIi8+PHBhdGggZD0ibTI0LjUgMTcgMyAxLjUgMy0xLjUgMS41LTMgMC00LjUtMS41LTMtMy0xLjUtMyAxLjVMMjAgMTB6Ii8+PHBhdGggZD0iTSA5LjUgMjMuNWMwLTMgMCAxMi41IDEzIDEyLjVTIDM3IDE5LjUgMzUuNSAyMy41bC0yIDdoLTE4eiIvPjxwYXRoIGQ9Ik0xMS41IDI5LjVsNSA5aDExbDUuNS05LjUiLz48cGF0aCBkPSJNIDguNSAxNS41bDIgMC0xLjUtMyAyLjUtNyAyLjUtNiIgc3Ryb2tlLWxpbmVjYXA9ImJ1dHQiLz48cGF0aCBkPSJNIDM2LjUgMTUuNS0yIDAtMS41IDMgMi41LTcgMi41LTYiIHN0cm9rZS1saW5lY2FwPSJidXR0Ii8+PC9nPjwvc3ZnPg==",
        bK: "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0NSIgaGVpZ2h0PSI0NSI+PGcgZmlsbD0iIzAwMCIgc3Ryb2tlPSIjMDAwIiBzdHJva2Utd2lkdGg9IjEuNSIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cGF0aCBkPSJNMjIuNSAxMS41bC0zIDkgOS0xIDQgMSA0LTFILjVsNi0xNC41Ii8+PHBhdGggZD0iTSAyNS41IDIwLjVoM20tMS41IDB2MyIgZmlsbD0ibm9uZSIgc3Ryb2tlLWxpbmVqb2luPSJtaXRlciIvPjxwYXRoIGQ9Ik0yMi41IDI5YzEuNS0yLjUgMS41LTQgMC0zLjVWMzhoMGgxMlYyNS41YzAtLjUtMy0xLTUgMGEzLjUgMy41IDAgMCAwLTIuNSAyLjVjLS41LjUtMS41IDAgMSAxLjVzLTEgMSA0Ljk5IDIuNDkiIHN0cm9rZS1saW5lY2FwPSJidXR0Ii8+PHBhdGggZD0iTSAxOS41IDM4aDVNMzMgMzkuNWwtMy41LTdMMjYgMzZoNi41TDMyIDM0bDIgNSIvPjxwYXRoIGQ9Im0gMjAgNyAzLjc1IDVMMjAgMTdoLS41bDItOSAyLjUgNi41LTUtNC41LTEuNSAzIDYgNi41LTQgNS0yLjUgNi41LTMtMnoiIHN0cm9rZS1saW5lY2FwPSJidXR0Ii8+PHBhdGggZD0ibSA4LjUgMjQtMS0yLjVMMTEgMjJsMyA2LjUtMS41IDQgMi41IDUuNWgtMjNsMi41LTUuNWgtMSA0LjUiIGZpbGw9IiMwMDAiIHN0cm9rZS1saW5lY2FwPSJidXR0Ii8+PC9nPjwvc3ZnPg=="
    };

    var board = null;
    var game = new Chess();
    var pgn = `[Event "Prueba"]
[Site "Online"]
[White "Jugador Blanco"]
[Black "Jugador Negro"]
[Result "1-0"]

1. e4 c5 2. Nf3 d6 3. d4 cxd4 4. Nxd4 Nf6 5. Nc3 a6 6. Bg5 e6 7. f4 Be7 8. Qf3 Qc7 9. O-O-O Nbd7 10. g4 b5 11. Bxf6 Nxf6 12. g5 Nd7 13. f5 Nc5 14. f6 gxf6 15. gxf6 Bf8 16. Rg1 Bb7 17. b4 Nd7 18. Bh3 O-O-O 19. Bxe6 fxe6 20. Nxe6 Qb6 21. Nxd8 Kxd8 22. f7 Bh6+ 23. Kb1 Rf8 24. Rg8 Ke7 25. Nd5+ Bxd5 26. exd5 Rxf7 27. Re1+ Ne5 28. Qg3 Qd4 29. c3 Qd2 30. Qh4+ Bg5 31. Rxe5+ dxe5 32. Qxg5+ Qxg5 33. Rxg5 Kd6 34. Rg8 Kxd5 35. Ra8 Rf6 36. Rd8+ Kc4 37. Rc8+ Kd3 38. Rd8+ Kxc3 39. a3 e4 40. Re8 Kd3 41. Rd8+ Ke2 42. Re8 e3 43. Kc2 Rc6+ 44. Kb3 Kd2 45. Rd8+ Ke1 46. Re8 e2 47. a4 bxa4+ 48. Kxa4 Rc2 49. Ka5 Ra2+ 50. Kb6 Kd1 51. Rd8+ Rd2 52. Re8 e1=Q 53. Rxe1+ Kxe1 54. Kxa6 Rxh2 55. b5 Rb2 56. b6 h5 57. b7 h4 58. Ka7 h3 59. b8=Q Rxb8 60. Kxb8 h2 1-0`;
    
    var comments = {
        1: "Comentario para la jugada 1.",
        8: "Comentario para la jugada 8.",
        20: "Momento táctico importante."
    };
    
    game.load_pgn(pgn);
    var history = game.history({ verbose: true });
    var currentMoveIndex = -1;

    function pieceTheme (piece) {
        // piece es por ej. 'bK', 'wQ', etc.
        return PIECE_THEME_BASE64[piece];
    }
    
    var config = {
      position: 'start',
      pieceTheme: pieceTheme
    };
    board = Chessboard('board-container', config);
    
    // ... el resto de la lógica de los botones es igual
    function updateDisplay() {
        var moveNumber = Math.floor(currentMoveIndex / 2) + 1;
        var comment = "---";

        if (currentMoveIndex === -1) {
            comment = "¡Usa los botones para comenzar!";
        } else if (comments[moveNumber]) {
            comment = `Jugada ${moveNumber}: ${comments[moveNumber]}`;
        } else {
            comment = `Movimiento ${moveNumber}: ${history[currentMoveIndex].san}`;
        }
        $('#commentary').text(comment);
        $('#startBtn').prop('disabled', currentMoveIndex <= -1);
        $('#prevBtn').prop('disabled', currentMoveIndex <= -1);
        $('#nextBtn').prop('disabled', currentMoveIndex >= history.length - 1);
        $('#endBtn').prop('disabled', currentMoveIndex >= history.length - 1);
    }

    $('#startBtn').on('click', function () {
        currentMoveIndex = -1; game.reset(); board.position('start'); updateDisplay();
    });
    $('#prevBtn').on('click', function () {
        if (currentMoveIndex > -1) { currentMoveIndex--; game.undo(); board.position(game.fen()); updateDisplay(); }
    });
    $('#nextBtn').on('click', function () {
        if (currentMoveIndex < history.length - 1) { currentMoveIndex++; game.move(history[currentMoveIndex].san); board.position(game.fen()); updateDisplay(); }
    });
    $('#endBtn').on('click', function () {
        game.load_pgn(pgn); board.position(game.fen()); currentMoveIndex = history.length - 1; updateDisplay();
    });
    
    updateDisplay();
});
</script>

</body>
</html>
